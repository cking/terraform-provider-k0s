---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "k0s_cluster Resource - terraform-provider-k0s"
subcategory: ""
description: |-
  Manages a k0s cluster.
---

# k0s_cluster (Resource)

Manages a k0s cluster.

## Example Usage

```terraform
resource "k0s_cluster" "example" {
  name    = "example"
  version = "1.27.2+k0s.0"

  hosts = [
    {
      role = "controller+worker"

      ssh = {
        address  = "10.0.0.1"
        port     = 22
        user     = "root"
        key_path = "~/.ssh/id_ed25519.pub"
      }
    },
    {
      role = "worker"

      ssh = {
        address  = "10.0.0.2"
        port     = 22
        user     = "root"
        key_path = "~/.ssh/id_ed25519.pub"
      }
    }
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `hosts` (Attributes Set) Hosts configuration. (see [below for nested schema](#nestedatt--hosts))
- `name` (String) Name of the cluster.
- `version` (String) Desired k0s version.

### Optional

- `concurrency` (Number) Maximum number of hosts to configure in parallel. If omitted, the default value is `0` (unlimited).
- `config` (String) Embedded k0s cluster configuration. When left out, the output of `k0s config create` will be used.
- `dynamic_config` (Boolean) Enable k0s dynamic config.
- `no_drain` (Boolean) Do not drain worker nodes when upgrading. If omitted, the default value is `false`.
- `no_wait` (Boolean) Do not wait for worker nodes to join. If omitted, the default value is `false`.
- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))

### Read-Only

- `id` (String) Unique ID of the cluster.
- `kubeconfig` (String, Sensitive) Admin kubeconfig of the cluster.

<a id="nestedatt--hosts"></a>
### Nested Schema for `hosts`

Required:

- `role` (String) Role of the host. One of `controller`, `controller+worker`, `single`, `worker`.
- `ssh` (Attributes) SSH connection options. (see [below for nested schema](#nestedatt--hosts--ssh))

Optional:

- `environment` (Map of String) List of key-value pairs to set to the target host's environment variables.
- `files` (Attributes List) List of files to be uploaded to the host. (see [below for nested schema](#nestedatt--hosts--files))
- `hostname` (String) Override host's hostname. When not set, the hostname reported by the operating system is used.
- `install_flags` (List of String) Extra flags passed to the `k0s install` command on the target host.
- `no_taints` (Boolean) When `true` and used in conjuction with the `controller+worker` role, the default taints are disabled making regular workloads schedulable on the node. By default, k0s sets a `node-role.kubernetes.io/master:NoSchedule` taint on `controller+worker` nodes and only workloads with toleration for it will be scheduled.
- `os` (String) Override OS distribution auto-detection.
- `private_address` (String) Override private IP address selected by host fact gathering.
- `private_interface` (String) Override private network interface selected by host fact gathering. Useful in case fact gathering picks the wrong private network interface.

<a id="nestedatt--hosts--ssh"></a>
### Nested Schema for `hosts.ssh`

Required:

- `address` (String) IP address of the host.
- `port` (Number) TCP port of the SSH service on the host.

Optional:

- `bastion` (Attributes) SSH bastion connection options. (see [below for nested schema](#nestedatt--hosts--ssh--bastion))
- `key` (String, Sensitive) SSH private key in PEM format.
- `key_path` (String) Path to an SSH private key file.
- `user` (String) Username to log in as.

<a id="nestedatt--hosts--ssh--bastion"></a>
### Nested Schema for `hosts.ssh.bastion`

Required:

- `address` (String) IP address of the host.
- `port` (Number) TCP port of the SSH service on the host.

Optional:

- `key` (String, Sensitive) SSH private key in PEM format.
- `key_path` (String) Path to an SSH private key file.
- `user` (String) Username to log in as.



<a id="nestedatt--hosts--files"></a>
### Nested Schema for `hosts.files`

Required:

- `dst` (String) Destination filename for the file
- `name` (String) name of the file bundle
- `src` (String) File path to the file to upload

Optional:

- `group` (String) Group name of file owner
- `perm` (String) File permission mode for uploaded file
- `user` (String) User name of file owner



<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours).
- `delete` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours). Setting a timeout for a Delete operation is only applicable if changes are saved into state before the destroy operation occurs.
- `update` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours).
